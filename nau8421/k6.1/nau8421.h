/* SPDX-License-Identifier: GPL-2.0-only */
/*
 * The NAU8421 ALSA SoC audio driver. The codec is a high quality 24-bit stereo DAC
 * with 8Vpp differential analog output capability.
 *
 * Copyright 2025 Nuvoton Technology Corp.
 * Author: John Hsu <kchsu0@nuvoton.com>
 */

#ifndef __NAU8421_H__
#define __NAU8421_H__

#define NAU8421_R00_HRESET		0x00
#define NAU8421_R01_SRESET		0x01
#define NAU8421_R02_DEVID		0x02
#define NAU8421_R03_SIREV		0x03
#define NAU8421_R04_SYSCTL		0x04
#define NAU8421_R05_MCLKDETDEM		0x05
#define NAU8421_R06_MUTEFUNC		0x06
#define NAU8421_R07_MUTECTL		0x07
#define NAU8421_R08_RCHDGAIN		0x08
#define NAU8421_R09_LCHDGAIN		0x09
#define NAU8421_R0A_I2SCTL		0x0A
#define NAU8421_R0B_I2SPTLST		0x0B
#define NAU8421_R0C_I2SPTRST		0x0C
#define NAU8421_R0D_DEMPA1L		0x0D
#define NAU8421_R0E_DEMPA1M		0x0E
#define NAU8421_R0F_DEMPA1H		0x0F
#define NAU8421_R13_DEMPB0L		0x13
#define NAU8421_R14_DEMPB0M		0x14
#define NAU8421_R15_DEMPB0H		0x15
#define NAU8421_R16_DEMPB1L		0x16
#define NAU8421_R17_DEMPB1M		0x17
#define NAU8421_R18_DEMPB1H		0x18
#define NAU8421_R1B_DEMCTL		0x1B
#define NAU8421_R1D_SDMDTR		0x1D
#define NAU8421_R1E_DEMASWCTL		0x1E
#define NAU8421_R1F_DEMASWTH		0x1F
#define NAU8421_R20_DEMASWTL		0x20
#define NAU8421_R28_ANACTL7		0x28
#define NAU8421_R29_ENVREFCTL		0x29
#define NAU8421_R32_STATUS		0x32
#define NAU8421_R33_STATUS		0x33
#define NAU8421_REG_MAX			NAU8421_R33_STATUS

/* SYSCTL (0x04) */
#define NAU8421_MCLKSRC_SFT		5
#define NAU8421_MCLKSRC_MASK		(0x7 << NAU8421_MCLKSRC_SFT)
#define NAU8421_OVSRATE_SFT		2
#define NAU8421_OVSRATE_MASK		(0x7 << NAU8421_OVSRATE_SFT)
#define NAU8421_OVSRATE_384		(0x6 << NAU8421_OVSRATE_SFT)
#define NAU8421_OVSRATE_256		(0x5 << NAU8421_OVSRATE_SFT)
#define NAU8421_OVSRATE_192		(0x4 << NAU8421_OVSRATE_SFT)
#define NAU8421_OVSRATE_128		(0x3 << NAU8421_OVSRATE_SFT)
#define NAU8421_OVSRATE_64		(0x2 << NAU8421_OVSRATE_SFT)
#define NAU8421_OVSRATE_32		(0x1 << NAU8421_OVSRATE_SFT)
#define NAU8421_DACLEN_SFT		1
#define NAU8421_DACREN_SFT		0

/* MCLKDETDEM (0x05) */
#define NAU8421_DEMSEL_SFT		7
#define NAU8421_DEMSEL_MASK		(0x1 << NAU8421_DEMSEL_SFT)
#define NAU8421_DEMSEL_SHU		(0x1 << NAU8421_DEMSEL_SFT)
#define NAU8421_DEMSEL_DWA		(0x0 << NAU8421_DEMSEL_SFT)
#define NAU8421_MCLKSPDD_SFT		3
#define NAU8421_MCLKSPDD_DIS		(0x1 << NAU8421_MCLKSPDD_SFT)
#define NAU8421_MCLKSPS_MASK		0x7
#define NAU8421_MCLKSPS_1152FS		0x7
#define NAU8421_MCLKSPS_768FS		0x6
#define NAU8421_MCLKSPS_512FS		0x5
#define NAU8421_MCLKSPS_384FS		0x4
#define NAU8421_MCLKSPS_256FS		0x3
#define NAU8421_MCLKSPS_192FS		0x2
#define NAU8421_MCLKSPS_128FS		0x1

/* MUTECTL (0x07) */
#define NAU8421_DGAINZC_SFT		3
#define NAU8421_DGAINZC_EN		(0x1 << NAU8421_DGAINZC_SFT)
#define NAU8421_SMUTE_EN		0x1

/* I2SCTL (0x0A) */
#define NAU8421_I2SDOPR_SFT		7
#define NAU8421_I2SDOPR_MASK		(0x1 << NAU8421_I2SDOPR_SFT)
#define NAU8421_I2SDOPR_PHAL		(0x1 << NAU8421_I2SDOPR_SFT)
#define NAU8421_I2SDOPR_PHAR		(0x0 << NAU8421_I2SDOPR_SFT)
#define NAU8421_I2SDOPL_SFT		6
#define NAU8421_I2SDOPL_MASK		(0x1 << NAU8421_I2SDOPL_SFT)
#define NAU8421_I2SDOPL_PHAR		(0x1 << NAU8421_I2SDOPL_SFT)
#define NAU8421_I2SDOPL_PHAL		(0x0 << NAU8421_I2SDOPL_SFT)
#define NAU8421_I2SFMT_SFT		3
#define NAU8421_I2SFMT_MASK		(0x7 << NAU8421_I2SFMT_SFT)
#define NAU8421_I2SFMT_PCMB		(0x7 << NAU8421_I2SFMT_SFT)
#define NAU8421_I2SFMT_PCMA		(0x6 << NAU8421_I2SFMT_SFT)
#define NAU8421_I2SFMT_PCMTS		(0x4 << NAU8421_I2SFMT_SFT)
#define NAU8421_I2SFMT_RJ		(0x2 << NAU8421_I2SFMT_SFT)
#define NAU8421_I2SFMT_LJ		(0x1 << NAU8421_I2SFMT_SFT)
#define NAU8421_I2SFMT_I2S		(0x0 << NAU8421_I2SFMT_SFT)
#define NAU8421_I2SWD_SFT		1
#define NAU8421_I2SWD_MASK		(0x3 << NAU8421_I2SWD_SFT)
#define NAU8421_I2SWD_32		(0x3 << NAU8421_I2SWD_SFT)
#define NAU8421_I2SWD_24		(0x2 << NAU8421_I2SWD_SFT)
#define NAU8421_I2SWD_20		(0x1 << NAU8421_I2SWD_SFT)
#define NAU8421_I2SWD_16		(0x0 << NAU8421_I2SWD_SFT)
#define NAU8421_I2SWDDET_DIS		0x1

/* DEMASWCTL (0x1E) */
#define NAU8421_DEMASWHL_SFT		4
#define NAU8421_DEMASWHL_MASK		(0x7 << NAU8421_DEMASWHL_SFT)
#define NAU8421_DEMASW_SFT		3
#define NAU8421_DEMASW_EN		(0x1 << NAU8421_DEMASW_SFT)

/* DEMASWTH (0x1F) */
#define NAU8421_DEMASWTH_MASK		0x3f

/* DEMASWTL (0x20) */
#define NAU8421_DEMASWTL_MASK		0x3f

/* ANACTL7 (0x28) */
#define NAU8421_ENOPARCTL_SFT		7
#define NAU8421_ENOPARCTL		(0x1 << NAU8421_ENOPARCTL_SFT)
#define NAU8421_ENOPAREN_SFT		6
#define NAU8421_ENOPAREN		(0x1 << NAU8421_ENOPAREN_SFT)
#define NAU8421_ENOPALCTL_SFT		5
#define NAU8421_ENOPALCTL		(0x1 << NAU8421_ENOPALCTL_SFT)
#define NAU8421_ENOPALEN_SFT		4
#define NAU8421_ENOPALEN		(0x1 << NAU8421_ENOPALEN_SFT)
#define NAU8421_RNRCTL_SFT		3
#define NAU8421_RNRCTL			(0x1 << NAU8421_RNRCTL_SFT)
#define NAU8421_RNREN_SFT		2
#define NAU8421_RNREN			(0x1 << NAU8421_RNREN_SFT)
#define NAU8421_RNLCTL_SFT		1
#define NAU8421_RNLCTL			(0x1 << NAU8421_RNLCTL_SFT)
#define NAU8421_RNLEN			0x1

/* ENVREFCTL (0x29) */
#define NAU8421_ENVREFCTL_SFT		1
#define NAU8421_ENVREFCTL		(0x1 << NAU8421_ENVREFCTL_SFT)
#define NAU8421_ENVREFEN		0x1

struct nau8421 {
	struct device *dev;
	struct regmap *regmap;
	struct gpio_desc *enable_pin; /* active high */
	struct gpio_desc *mute_pin; /* active low */
	int mutei_status; /* 1: level high (unmute); 0: level low (mute) */
	int clock_detection;
	int sysclk;
	int fs;
	int osr_id;
};

#endif /* __NAU8421_H__ */
